"use strict";var g=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var B=(e,t)=>{for(var n in t)g(e,n,{get:t[n],enumerable:!0})},N=(e,t,n,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of O(t))!_.call(e,i)&&i!==n&&g(e,i,{get:()=>t[i],enumerable:!(c=K(t,i))||c.enumerable});return e};var V=e=>N(g({},"__esModule",{value:!0}),e);var J={};B(J,{default:()=>q});module.exports=V(J);var m=require("@raycast/api"),P=require("react");var d=require("@raycast/api"),h=require("react/jsx-runtime");var C=e=>(0,h.jsx)(d.Action.CopyToClipboard,{icon:d.Icon.CopyClipboard,...e});var w=({icon:e=d.Icon.Trash,title:t,dialog:n,onAction:c,shortcut:i={modifiers:["ctrl"],key:"x"}})=>(0,h.jsx)(d.Action,{style:d.Action.Style.Destructive,icon:e,title:t,onAction:async()=>{await(0,d.confirmAlert)({title:n.title??t,message:n.message??"This action cannot be undone",icon:e,primaryAction:{title:n.primaryButton??t,style:d.Alert.ActionStyle.Destructive,onAction:c}})},shortcut:i});var D=require("@raycast/api");var u=require("react/jsx-runtime"),x=({question:e,answer:t})=>(0,u.jsxs)(D.ActionPanel.Section,{title:"Copy",children:[(0,u.jsx)(C,{title:"Copy Answer",content:t}),(0,u.jsx)(C,{title:"Copy Question",content:e})]});var S=require("@raycast/api"),v=require("react/jsx-runtime"),I=()=>(0,v.jsx)(S.ActionPanel.Section,{title:"Preferences",children:(0,v.jsx)(S.Action,{icon:S.Icon.Gear,title:"Open Extension Preferences",onAction:S.openExtensionPreferences})});var s=require("@raycast/api"),l=require("react");function L(){let[e,t]=(0,l.useState)([]),[n,c]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{let a=await s.LocalStorage.getItem("savedChats");a&&t(o=>[...o,...JSON.parse(a)]),c(!1)})()},[]),(0,l.useEffect)(()=>{s.LocalStorage.setItem("savedChats",JSON.stringify(e))},[e]);let i=(0,l.useCallback)(async a=>{let o=await(0,s.showToast)({title:"Saving your answer...",style:s.Toast.Style.Animated}),p={...a,saved_at:new Date().toISOString()};t([...e,p]),o.title="Answer saved!",o.style=s.Toast.Style.Success},[t,e]),y=(0,l.useCallback)(async a=>{let o=await(0,s.showToast)({title:"Unsaving your answer...",style:s.Toast.Style.Animated}),p=e.filter(A=>A.id!==a.id);t(p),o.title="Answer unsaved!",o.style=s.Toast.Style.Success},[t,e]),f=(0,l.useCallback)(async()=>{let a=await(0,s.showToast)({title:"Clearing your saved answers...",style:s.Toast.Style.Animated});t([]),a.title="Saved answers cleared!",a.style=s.Toast.Style.Success},[t]);return(0,l.useMemo)(()=>({data:e,isLoading:n,add:i,remove:y,clear:f}),[e,n,i,y,f])}var b=require("@raycast/api"),k=require("react/jsx-runtime"),T=e=>{let{chat:t,streamData:n}=e,c=n&&n.id===t.id,i=`**${t.question}**

${c?n.answer:t.answer}`;return(0,k.jsx)(b.List.Item.Detail,{markdown:i})};var r=require("react/jsx-runtime");function q(){let e=L(),[t,n]=(0,P.useState)(""),[c,i]=(0,P.useState)(null),y=o=>(0,r.jsxs)(m.ActionPanel,{children:[(0,r.jsx)(x,{answer:o.answer,question:o.question}),(0,r.jsxs)(m.ActionPanel.Section,{title:"Delete",children:[(0,r.jsx)(w,{title:"Unsave",dialog:{title:"Are you sure you want to unsave this answer from your collection?"},onAction:()=>e.remove(o)}),(0,r.jsx)(w,{title:"Clear All",dialog:{title:"Are you sure you want to clear all your saved answer from your collection?"},onAction:()=>e.clear(),shortcut:{modifiers:["cmd","shift"],key:"delete"}})]}),(0,r.jsx)(I,{})]}),a=e.data.sort((o,p)=>new Date(p.saved_at??0).getTime()-new Date(o.saved_at??0).getTime()).filter((o,p,A)=>p===A.findIndex(E=>E.id===o.id)).filter(o=>t===""?!0:o.question.toLowerCase().includes(t.toLowerCase())||o.answer.toLowerCase().includes(t.toLowerCase()));return(0,r.jsx)(m.List,{isShowingDetail:a.length!==0,isLoading:e.isLoading,filtering:!1,throttle:!1,selectedItemId:c||void 0,onSelectionChange:o=>{o!==c&&i(o)},searchBarPlaceholder:"Search saved answer/question...",searchText:t,onSearchTextChange:n,children:e.data.length===0?(0,r.jsx)(m.List.EmptyView,{title:"No saved answers",description:"Save generated question with \u2318 + S shortcut",icon:m.Icon.Stars}):(0,r.jsx)(m.List.Section,{title:"Saved",subtitle:a.length.toLocaleString(),children:a.map(o=>(0,r.jsx)(m.List.Item,{id:o.id,title:o.question,accessories:[{text:new Date(o.created_at??0).toLocaleDateString()}],detail:(0,r.jsx)(T,{chat:o}),actions:o&&c===o.id?y(o):void 0},o.id))})})}
